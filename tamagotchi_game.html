<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–º–∞–≥–æ—á–∏ - –ò–≥—Ä–∞</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
        }
        
        .pet-display {
            font-size: 80px;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .pet-name {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .hunger-fill { background: #ff6b6b; }
        .energy-fill { background: #4ecdc4; }
        .mood-fill { background: #45b7d1; }
        .hygiene-fill { background: #96ceb4; }
        
        .actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }
        
        .action-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .action-btn:active {
            transform: translateY(0);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .action-emoji {
            font-size: 24px;
        }
        
        .status-message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
            min-height: 20px;
        }
        
        .coins-display {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            font-size: 18px;
            font-weight: bold;
        }
        
        .level-display {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
        }
        
        .sleep-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .sleep-message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .sleep-emoji {
            font-size: 60px;
            margin-bottom: 20px;
        }
        
        .sleep-time {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .wake-up-btn {
            background: #4ecdc4;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–ª—É–ø–ª–µ–Ω–∏—è */
        .hatching-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            flex-direction: column;
        }
        
        .egg-container {
            position: relative;
            cursor: pointer;
            user-select: none;
            margin-bottom: 30px;
        }
        
        .egg {
            font-size: 120px;
            animation: bounce 1s infinite;
            transition: all 0.3s ease;
        }
        
        .egg:hover {
            transform: scale(1.1);
        }
        
        .egg.clicked {
            animation: shake 0.5s infinite;
        }
        
        .hatching-text {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .click-instruction {
            font-size: 16px;
            text-align: center;
            margin: 10px 0;
            opacity: 0.8;
            animation: blink 2s infinite;
        }
        
        .crack {
            position: absolute;
            top: 0;
            left: 0;
            font-size: 120px;
            color: rgba(255, 255, 255, 0.3);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .crack.show {
            opacity: 1;
            animation: crack-appear 0.5s ease-in-out;
        }
        
        .crack-line {
            position: absolute;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 2px;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .crack-line.show {
            opacity: 1;
            animation: crack-grow 0.5s ease-out;
        }
        
        .crack-line-1 {
            width: 60px;
            height: 3px;
            top: 30px;
            left: 20px;
            transform: rotate(15deg);
        }
        
        .crack-line-2 {
            width: 40px;
            height: 3px;
            top: 50px;
            right: 25px;
            transform: rotate(-20deg);
        }
        
        .crack-line-3 {
            width: 50px;
            height: 3px;
            bottom: 40px;
            left: 30px;
            transform: rotate(45deg);
        }
        
        .crack-line-4 {
            width: 35px;
            height: 3px;
            bottom: 60px;
            right: 20px;
            transform: rotate(-30deg);
        }
        
        .pet-emerging {
            font-size: 120px;
            animation: emerge 1s ease-out;
            margin-bottom: 30px;
        }
        
        .name-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-size: 18px;
            text-align: center;
            margin: 20px 0;
            width: 200px;
        }
        
        .name-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .hatch-btn {
            background: #4ecdc4;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @keyframes crack-appear {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes crack-grow {
            0% { width: 0; opacity: 0; }
            100% { width: var(--crack-width); opacity: 1; }
        }
        
        @keyframes blink {
            0%, 50% { opacity: 0.8; }
            51%, 100% { opacity: 0.4; }
        }
        
        @keyframes emerge {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pet-display.happy {
            animation: pulse 1s infinite;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- –û–≤–µ—Ä–ª–µ–π –≤—ã–ª—É–ø–ª–µ–Ω–∏—è -->
    <div class="hatching-overlay" id="hatchingOverlay">
        <div class="egg-container" id="eggContainer" onclick="crackEgg()">
            <div class="egg" id="egg">ü•ö</div>
            <div class="crack hidden" id="crack">üí•</div>
            <div class="crack-line crack-line-1" id="crackLine1"></div>
            <div class="crack-line crack-line-2" id="crackLine2"></div>
            <div class="crack-line crack-line-3" id="crackLine3"></div>
            <div class="crack-line crack-line-4" id="crackLine4"></div>
        </div>
        <div class="hatching-text" id="hatchingText">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è–π—Ü–æ, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –ø–∏—Ç–æ–º—Ü—É –≤—ã–ª—É–ø–∏—Ç—å—Å—è!</div>
        <div class="click-instruction" id="clickInstruction">üëÜ –ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ —è–π—Ü–æ, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–µ—â–∏–Ω—ã</div>
        <div class="pet-emerging hidden" id="petEmerging"></div>
        <input type="text" class="name-input hidden" id="nameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–∏—Ç–æ–º—Ü–∞" maxlength="20">
        <button class="hatch-btn hidden" id="hatchBtn" onclick="completeHatching()">–í—ã–ª—É–ø–∏—Ç—å!</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–∞ -->
    <div class="game-container hidden" id="gameContainer">
        <div class="pet-display" id="petDisplay">üê±</div>
        <div class="pet-name" id="petName">–ú–æ–π –ø–∏—Ç–æ–º–µ—Ü</div>
        
        <div class="level-display">
            <div>‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></div>
            <div>üí´ –û–ø—ã—Ç: <span id="exp">0</span>/100</div>
            <div>üéÇ –í–æ–∑—Ä–∞—Å—Ç: <span id="age">0 –¥–Ω–µ–π</span></div>
        </div>
        
        <div class="coins-display">
            üí∞ –ú–æ–Ω–µ—Ç—ã: <span id="coins">100</span>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">üçï –ì–æ–ª–æ–¥</div>
                <div class="stat-value" id="hungerValue">50%</div>
                <div class="progress-bar">
                    <div class="progress-fill hunger-fill" id="hungerBar" style="width: 50%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">‚ö° –≠–Ω–µ—Ä–≥–∏—è</div>
                <div class="stat-value" id="energyValue">50%</div>
                <div class="progress-bar">
                    <div class="progress-fill energy-fill" id="energyBar" style="width: 50%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                <div class="stat-value" id="moodValue">50%</div>
                <div class="progress-bar">
                    <div class="progress-fill mood-fill" id="moodBar" style="width: 50%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-label">üõÅ –ì–∏–≥–∏–µ–Ω–∞</div>
                <div class="stat-value" id="hygieneValue">50%</div>
                <div class="progress-bar">
                    <div class="progress-fill hygiene-fill" id="hygieneBar" style="width: 50%"></div>
                </div>
            </div>
        </div>
        
        <div class="status-message" id="statusMessage">–ü–∏—Ç–æ–º–µ—Ü —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è —Ö–æ—Ä–æ—à–æ!</div>
        
        <div class="actions">
            <button class="action-btn" id="feedBtn" onclick="feedPet()">
                <div class="action-emoji">üçï</div>
                <div>–ü–æ–∫–æ—Ä–º–∏—Ç—å</div>
            </button>
            <button class="action-btn" id="playBtn" onclick="playWithPet()">
                <div class="action-emoji">üéÆ</div>
                <div>–ò–≥—Ä–∞—Ç—å</div>
            </button>
            <button class="action-btn" id="cleanBtn" onclick="cleanPet()">
                <div class="action-emoji">üõÅ</div>
                <div>–ú—ã—Ç—å</div>
            </button>
            <button class="action-btn" id="sleepBtn" onclick="putToSleep()">
                <div class="action-emoji">üò¥</div>
                <div>–°–ø–∞—Ç—å</div>
            </button>
        </div>
        
        <div class="actions">
            <button class="action-btn" onclick="showGames()">
                <div class="action-emoji">üé≤</div>
                <div>–ò–≥—Ä—ã</div>
            </button>
            <button class="action-btn" onclick="showShop()">
                <div class="action-emoji">üõí</div>
                <div>–ú–∞–≥–∞–∑–∏–Ω</div>
            </button>
        </div>
        
        <div class="actions">
            <button class="action-btn" onclick="syncWithBot()">
                <div class="action-emoji">üîÑ</div>
                <div>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</div>
            </button>
            <button class="action-btn" onclick="savePetData()">
                <div class="action-emoji">üíæ</div>
                <div>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</div>
            </button>
        </div>
    </div>
    
    <div class="sleep-overlay" id="sleepOverlay">
        <div class="sleep-message">
            <div class="sleep-emoji">üò¥</div>
            <div class="sleep-time" id="sleepTime">–°–ø–∏—Ç –µ—â–µ: 01:30</div>
            <div>–≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è...</div>
            <button class="wake-up-btn" onclick="wakeUp()">–†–∞–∑–±—É–¥–∏—Ç—å</button>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // Telegram WebApp API
        const tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        tg.ready();
        tg.expand();
        
        // –î–∞–Ω–Ω—ã–µ –ø–∏—Ç–æ–º—Ü–∞
        let petData = {
            name: '–ú–æ–π –ø–∏—Ç–æ–º–µ—Ü',
            type: 'cat',
            level: 1,
            exp: 0,
            coins: 100,
            hunger: 50,
            energy: 50,
            mood: 50,
            hygiene: 50,
            isSleeping: false,
            sleepUntil: null,
            lastAction: null,
            actionCooldown: 0,
            lifeDays: 0,
            lastFeedDay: null,
            isHatched: false
        };
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
        let telegramUser = null;
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            telegramUser = tg.initDataUnsafe.user;
            console.log('Telegram user:', telegramUser);
        }
        
        // –¢–∏–ø—ã –ø–∏—Ç–æ–º—Ü–µ–≤ –∏ –∏—Ö —ç–º–æ–¥–∑–∏
        const petTypes = {
            'cat': 'üê±',
            'dog': 'üê∂',
            'rabbit': 'üê∞',
            'hamster': 'üêπ'
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–∏—Ç–æ–º—Ü–∞
        const petStates = {
            'happy': 'üòä',
            'normal': 'üòê',
            'sad': 'üò¢',
            'very_sad': 'üò≠',
            'sleeping': 'üò¥'
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadPetData();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –ø–∏—Ç–æ–º–µ—Ü
            if (petData.isHatched) {
                startGame();
            } else {
                startHatching();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ Telegram
            tg.MainButton.setText('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É');
            tg.MainButton.onClick(() => {
                savePetData();
                tg.close();
            });
            
            tg.BackButton.onClick(() => {
                savePetData();
                tg.close();
            });
        }
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–ª—É–ø–ª–µ–Ω–∏—è
        let crackCount = 0;
        let maxCracks = 4;
        
        // –ù–∞—á–∞–ª–æ –≤—ã–ª—É–ø–ª–µ–Ω–∏—è
        function startHatching() {
            document.getElementById('hatchingOverlay').classList.remove('hidden');
            document.getElementById('gameContainer').classList.add('hidden');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Ç—Ä–µ—â–∏–Ω
            crackCount = 0;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            document.getElementById('hatchingText').textContent = '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è–π—Ü–æ, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –ø–∏—Ç–æ–º—Ü—É –≤—ã–ª—É–ø–∏—Ç—å—Å—è!';
            document.getElementById('clickInstruction').classList.remove('hidden');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —è–π—Ü—É
        function crackEgg() {
            if (crackCount >= maxCracks) return;
            
            crackCount++;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Ç—Ä—è—Å–∫–∏
            const egg = document.getElementById('egg');
            egg.classList.add('clicked');
            
            setTimeout(() => {
                egg.classList.remove('clicked');
            }, 500);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—Ä–µ—â–∏–Ω—É
            const crackLine = document.getElementById(`crackLine${crackCount}`);
            crackLine.classList.add('show');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            if (crackCount === 1) {
                document.getElementById('hatchingText').textContent = '–ü–µ—Ä–≤–∞—è —Ç—Ä–µ—â–∏–Ω–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!';
            } else if (crackCount === 2) {
                document.getElementById('hatchingText').textContent = '–¢—Ä–µ—â–∏–Ω—ã —Ä–∞—Å—Ç—É—Ç! –ï—â–µ –Ω–µ–º–Ω–æ–≥–æ!';
            } else if (crackCount === 3) {
                document.getElementById('hatchingText').textContent = '–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ! –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–ª–∏–∫!';
            } else if (crackCount === maxCracks) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç—Ä–µ—â–∏–Ω—É
                document.getElementById('crack').classList.remove('hidden');
                document.getElementById('crack').classList.add('show');
                document.getElementById('hatchingText').textContent = '–Ø–π—Ü–æ —Ç—Ä–µ—Å–Ω—É–ª–æ! –ü–∏—Ç–æ–º–µ—Ü –≤—ã–ª—É–ø–ª—è–µ—Ç—Å—è!';
                document.getElementById('clickInstruction').classList.add('hidden');
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
                setTimeout(() => {
                    showPetEmerging();
                }, 1500);
            }
        }
        
        // –ü–æ–∫–∞–∑ –≤—ã–ª—É–ø–ª—è—é—â–µ–≥–æ—Å—è –ø–∏—Ç–æ–º—Ü–∞
        function showPetEmerging() {
            const petType = getRandomPetType();
            const petEmoji = petTypes[petType];
            
            document.getElementById('egg').classList.add('hidden');
            document.getElementById('crack').classList.add('hidden');
            document.getElementById('petEmerging').textContent = petEmoji;
            document.getElementById('petEmerging').classList.remove('hidden');
            document.getElementById('hatchingText').textContent = '–ü–∏—Ç–æ–º–µ—Ü –≤—ã–ª—É–ø–ª—è–µ—Ç—Å—è!';
            
            petData.type = petType;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
            setTimeout(() => {
                document.getElementById('nameInput').classList.remove('hidden');
                document.getElementById('hatchBtn').classList.remove('hidden');
                document.getElementById('hatchingText').textContent = '–î–∞–π—Ç–µ –∏–º—è –≤–∞—à–µ–º—É –ø–∏—Ç–æ–º—Ü—É!';
            }, 2000);
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—ã–ª—É–ø–ª–µ–Ω–∏—è
        function completeHatching() {
            const name = document.getElementById('nameInput').value.trim();
            if (name) {
                petData.name = name;
            }
            
            petData.isHatched = true;
            petData.lastFeedDay = new Date().toDateString();
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π –≤—ã–ª—É–ø–ª–µ–Ω–∏—è
            document.getElementById('hatchingOverlay').classList.add('hidden');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
            startGame();
            
            showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! ${petData.name} –≤—ã–ª—É–ø–∏–ª—Å—è!`);
        }
        
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            document.getElementById('hatchingOverlay').classList.add('hidden');
            document.getElementById('gameContainer').classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateDisplay();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            startGameLoop();
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º—Å—è —Å –±–æ—Ç–æ–º
            syncWithBot();
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ç–∏–ø–∞ –ø–∏—Ç–æ–º—Ü–∞
        function getRandomPetType() {
            const types = Object.keys(petTypes);
            return types[Math.floor(Math.random() * types.length)];
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–∞
        function loadPetData() {
            const saved = localStorage.getItem('tamagotchi_pet');
            if (saved) {
                const savedData = JSON.parse(saved);
                petData = { ...petData, ...savedData };
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–∞
        function savePetData() {
            localStorage.setItem('tamagotchi_pet', JSON.stringify(petData));
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–æ—Ç
            if (tg.sendData) {
                const dataToSend = {
                    action: 'update_pet_data',
                    petData: petData,
                    user: telegramUser
                };
                tg.sendData(JSON.stringify(dataToSend));
            }
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–æ—Ç–æ–º
        async function syncWithBot() {
            if (!telegramUser) return;
            
            try {
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∏—Ç–æ–º—Ü–µ–≤ —É –±–æ—Ç–∞
                const requestData = {
                    action: 'get_pet_data',
                    userId: telegramUser.id
                };
                
                if (tg.sendData) {
                    tg.sendData(JSON.stringify(requestData));
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ fallback
                loadPetData();
                updateDisplay();
                
            } catch (error) {
                console.log('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –±–æ—Ç–æ–º:', error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                loadPetData();
                updateDisplay();
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±–æ—Ç–∞
        function handleBotResponse(data) {
            if (data.action === 'pet_data_response' && data.pets) {
                if (data.pets.length > 0) {
                    // –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                    const botPet = data.pets[0];
                    petData = { ...petData, ...botPet };
                    updateDisplay();
                    showNotification('–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –±–æ—Ç–æ–º! üîÑ');
                }
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∏ —Ç–∏–ø –ø–∏—Ç–æ–º—Ü–∞
            document.getElementById('petName').textContent = petData.name;
            document.getElementById('petDisplay').textContent = getPetEmoji();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –∏ –æ–ø—ã—Ç
            document.getElementById('level').textContent = petData.level;
            const expNeeded = petData.level * 100;
            const expProgress = petData.exp % 100;
            document.getElementById('exp').textContent = `${expProgress}/${100}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç
            const ageText = petData.lifeDays === 0 ? '–Ω–æ–≤–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã–π' : `${petData.lifeDays} –¥–Ω–µ–π`;
            document.getElementById('age').textContent = ageText;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–Ω–µ—Ç—ã
            document.getElementById('coins').textContent = petData.coins;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStat('hunger', petData.hunger);
            updateStat('energy', petData.energy);
            updateStat('mood', petData.mood);
            updateStat('hygiene', petData.hygiene);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            updateStatus();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–Ω
            if (petData.isSleeping) {
                showSleepOverlay();
            } else {
                hideSleepOverlay();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            updateButtons();
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –ø–∏—Ç–æ–º—Ü–∞
        function getPetEmoji() {
            const baseEmoji = petTypes[petData.type] || 'üê±';
            const state = getPetState();
            return state === 'sleeping' ? baseEmoji + 'üò¥' : baseEmoji + petStates[state];
        }
        
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∏—Ç–æ–º—Ü–∞
        function getPetState() {
            if (petData.isSleeping) return 'sleeping';
            
            const avg = (petData.hunger + petData.energy + petData.mood + petData.hygiene) / 4;
            
            if (avg >= 80) return 'happy';
            if (avg >= 50) return 'normal';
            if (avg >= 20) return 'sad';
            return 'very_sad';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStat(stat, value) {
            document.getElementById(stat + 'Value').textContent = value + '%';
            document.getElementById(stat + 'Bar').style.width = value + '%';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
        function updateStatus() {
            const state = getPetState();
            const messages = {
                'happy': '–ü–∏—Ç–æ–º–µ—Ü –æ—á–µ–Ω—å —Å—á–∞—Å—Ç–ª–∏–≤! üåü',
                'normal': '–ü–∏—Ç–æ–º–µ—Ü —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è —Ö–æ—Ä–æ—à–æ! ‚≠ê',
                'sad': '–ü–∏—Ç–æ–º–µ—Ü –≥—Ä—É—Å—Ç–∏—Ç... üò¢',
                'very_sad': '–ü–∏—Ç–æ–º—Ü—É –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å! üò≠',
                'sleeping': '–ü–∏—Ç–æ–º–µ—Ü —Å–ø–∏—Ç... üò¥'
            };
            
            document.getElementById('statusMessage').textContent = messages[state] || '–ü–∏—Ç–æ–º–µ—Ü —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è —Ö–æ—Ä–æ—à–æ!';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        function updateButtons() {
            const buttons = ['feedBtn', 'playBtn', 'cleanBtn', 'sleepBtn'];
            buttons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (petData.actionCooldown > 0) {
                    btn.disabled = true;
                    btn.textContent = `‚è≥ ${petData.actionCooldown}—Å`;
                } else {
                    btn.disabled = false;
                    btn.innerHTML = getButtonHTML(btnId);
                }
            });
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ HTML –∫–Ω–æ–ø–∫–∏
        function getButtonHTML(btnId) {
            const buttons = {
                'feedBtn': '<div class="action-emoji">üçï</div><div>–ü–æ–∫–æ—Ä–º–∏—Ç—å</div>',
                'playBtn': '<div class="action-emoji">üéÆ</div><div>–ò–≥—Ä–∞—Ç—å</div>',
                'cleanBtn': '<div class="action-emoji">üõÅ</div><div>–ú—ã—Ç—å</div>',
                'sleepBtn': '<div class="action-emoji">üò¥</div><div>–°–ø–∞—Ç—å</div>'
            };
            return buttons[btnId] || '';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π —Å–Ω–∞
        function showSleepOverlay() {
            document.getElementById('sleepOverlay').style.display = 'flex';
            updateSleepTime();
        }
        
        // –°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π —Å–Ω–∞
        function hideSleepOverlay() {
            document.getElementById('sleepOverlay').style.display = 'none';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–Ω–∞
        function updateSleepTime() {
            if (!petData.isSleeping || !petData.sleepUntil) return;
            
            const now = new Date();
            const sleepEnd = new Date(petData.sleepUntil);
            const remaining = sleepEnd - now;
            
            if (remaining <= 0) {
                wakeUp();
                return;
            }
            
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            
            document.getElementById('sleepTime').textContent = 
                `–°–ø–∏—Ç –µ—â–µ: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // –î–µ–π—Å—Ç–≤–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º
        function feedPet() {
            if (petData.actionCooldown > 0) return;
            
            petData.hunger = Math.min(100, petData.hunger + 20);
            petData.mood = Math.min(100, petData.mood + 5);
            petData.coins = Math.max(0, petData.coins - 5);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç –ø—Ä–∏ –∫–æ—Ä–º–ª–µ–Ω–∏–∏
            updateAge();
            
            addExp(5);
            startActionCooldown();
            showNotification('–ü–∏—Ç–æ–º–µ—Ü –ø–æ–∫–æ—Ä–º–ª–µ–Ω! üçï +5 –æ–ø—ã—Ç–∞');
            updateDisplay();
            savePetData();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞
        function updateAge() {
            const today = new Date().toDateString();
            if (petData.lastFeedDay !== today) {
                petData.lifeDays++;
                petData.lastFeedDay = today;
            }
        }
        
        // –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π
        function checkLevelUp() {
            const expNeeded = petData.level * 100;
            if (petData.exp >= expNeeded) {
                petData.level++;
                petData.exp -= expNeeded;
                showNotification(`üéâ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: ${petData.level}!`);
                return true;
            }
            return false;
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø—ã—Ç–∞
        function addExp(amount) {
            petData.exp += amount;
            checkLevelUp();
        }
        
        function playWithPet() {
            if (petData.actionCooldown > 0) return;
            
            petData.mood = Math.min(100, petData.mood + 15);
            petData.energy = Math.max(0, petData.energy - 10);
            petData.hunger = Math.max(0, petData.hunger - 5);
            
            addExp(3);
            startActionCooldown();
            showNotification('–ü–∏—Ç–æ–º–µ—Ü –ø–æ–∏–≥—Ä–∞–ª! üéÆ +3 –æ–ø—ã—Ç–∞');
            updateDisplay();
            savePetData();
        }
        
        function cleanPet() {
            if (petData.actionCooldown > 0) return;
            
            petData.hygiene = Math.min(100, petData.hygiene + 25);
            petData.mood = Math.min(100, petData.mood + 10);
            petData.energy = Math.max(0, petData.energy - 5);
            
            addExp(2);
            startActionCooldown();
            showNotification('–ü–∏—Ç–æ–º–µ—Ü –ø–æ–º—ã—Ç! üõÅ +2 –æ–ø—ã—Ç–∞');
            updateDisplay();
            savePetData();
        }
        
        function putToSleep() {
            if (petData.actionCooldown > 0) return;
            
            petData.isSleeping = true;
            petData.sleepUntil = new Date(Date.now() + 90 * 60 * 1000); // 90 –º–∏–Ω—É—Ç
            
            startActionCooldown();
            showNotification('–ü–∏—Ç–æ–º–µ—Ü —É—Å–Ω—É–ª! üò¥');
            updateDisplay();
        }
        
        function wakeUp() {
            if (!petData.isSleeping) return;
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é
            const sleepDuration = 90; // –º–∏–Ω—É—Ç
            const energyRestore = Math.min(100, petData.energy + 50);
            petData.energy = energyRestore;
            
            petData.isSleeping = false;
            petData.sleepUntil = null;
            
            showNotification('–ü–∏—Ç–æ–º–µ—Ü –ø—Ä–æ—Å–Ω—É–ª—Å—è! ‚ö°');
            updateDisplay();
        }
        
        // –ó–∞–ø—É—Å–∫ –∫—É–ª–¥–∞—É–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è
        function startActionCooldown() {
            petData.actionCooldown = 10; // 10 —Å–µ–∫—É–Ω–¥
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function startGameLoop() {
            setInterval(() => {
                // –£–º–µ–Ω—å—à–∞–µ–º –∫—É–ª–¥–∞—É–Ω
                if (petData.actionCooldown > 0) {
                    petData.actionCooldown--;
                }
                
                // –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                if (!petData.isSleeping) {
                    petData.hunger = Math.max(0, petData.hunger - 1);
                    petData.energy = Math.max(0, petData.energy - 1);
                    petData.mood = Math.max(0, petData.mood - 1);
                    petData.hygiene = Math.max(0, petData.hygiene - 1);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updateDisplay();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                if (Date.now() % 30000 < 1000) {
                    savePetData();
                }
            }, 1000);
        }
        
        // –ú–∏–Ω–∏-–∏–≥—Ä—ã
        function showGames() {
            const gameText = `
üé≤ –ú–∏–Ω–∏-–∏–≥—Ä—ã

–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É:
‚Ä¢ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ (5 –º–æ–Ω–µ—Ç) - –≤—ã–∏–≥—Ä—ã—à: 10 –º–æ–Ω–µ—Ç
‚Ä¢ –û—Ä—ë–ª –∏–ª–∏ —Ä–µ—à–∫–∞ (3 –º–æ–Ω–µ—Ç—ã) - –≤—ã–∏–≥—Ä—ã—à: 6 –º–æ–Ω–µ—Ç  
‚Ä¢ –ö–æ—Å—Ç–∏ (4 –º–æ–Ω–µ—Ç—ã) - –≤—ã–∏–≥—Ä—ã—à: 8 –º–æ–Ω–µ—Ç

–£ –≤–∞—Å: ${petData.coins} –º–æ–Ω–µ—Ç
            `;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–≥—Ä–∞–º–∏
            showGameModal(gameText);
        }
        
        function showGameModal(text) {
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–≥—Ä
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 2000;
            `;
            
            const content = document.createElement('div');
            content.style.cssText = `
                background: rgba(255,255,255,0.1);
                border-radius: 20px;
                padding: 30px;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255,255,255,0.2);
                max-width: 400px;
                text-align: center;
                color: white;
            `;
            
            content.innerHTML = `
                <div style="white-space: pre-line; margin-bottom: 20px;">${text}</div>
                <div id="gameButtons"></div>
                <button onclick="this.parentElement.parentElement.remove()" 
                        style="background: #ff6b6b; border: none; border-radius: 10px; padding: 10px 20px; color: white; margin-top: 20px; cursor: pointer;">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
            `;
            
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –∏–≥—Ä
            const buttonsContainer = content.querySelector('#gameButtons');
            const games = [
                { name: 'üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ', cost: 5, reward: 10, func: 'playGuessGame' },
                { name: 'ü™ô –û—Ä—ë–ª/–†–µ—à–∫–∞', cost: 3, reward: 6, func: 'playCoinGame' },
                { name: 'üé≤ –ö–æ—Å—Ç–∏', cost: 4, reward: 8, func: 'playDiceGame' }
            ];
            
            games.forEach(game => {
                const button = document.createElement('button');
                button.textContent = `${game.name} (${game.cost}üí∞)`;
                button.style.cssText = `
                    display: block;
                    width: 100%;
                    margin: 10px 0;
                    padding: 15px;
                    background: ${petData.coins >= game.cost ? '#4ecdc4' : '#666'};
                    border: none;
                    border-radius: 10px;
                    color: white;
                    font-size: 16px;
                    cursor: ${petData.coins >= game.cost ? 'pointer' : 'not-allowed'};
                `;
                
                if (petData.coins >= game.cost) {
                    button.onclick = () => {
                        modal.remove();
                        window[game.func]();
                    };
                }
                
                buttonsContainer.appendChild(button);
            });
        }
        
        // –ò–≥—Ä–∞ "–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ"
        function playGuessGame() {
            if (petData.coins < 5) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç! üí∞');
                return;
            }
            
            const number = Math.floor(Math.random() * 10) + 1;
            const userGuess = prompt('–£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10:');
            
            if (userGuess === null) return;
            
            const guess = parseInt(userGuess);
            if (isNaN(guess) || guess < 1 || guess > 10) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10!');
                return;
            }
            
            petData.coins -= 5;
            
            if (guess === number) {
                petData.coins += 10;
                petData.exp += 5;
                showNotification(`üéâ –ü–æ–±–µ–¥–∞! –ß–∏—Å–ª–æ –±—ã–ª–æ ${number}. –ü–æ–ª—É—á–µ–Ω–æ: 10 –º–æ–Ω–µ—Ç, 5 –æ–ø—ã—Ç–∞!`);
            } else {
                showNotification(`üòî –ü—Ä–æ–∏–≥—Ä—ã—à! –ß–∏—Å–ª–æ –±—ã–ª–æ ${number}. –ü–æ—Ç–µ—Ä—è–Ω–æ: 5 –º–æ–Ω–µ—Ç`);
            }
            
            updateDisplay();
            savePetData();
        }
        
        // –ò–≥—Ä–∞ "–û—Ä—ë–ª –∏–ª–∏ —Ä–µ—à–∫–∞"
        function playCoinGame() {
            if (petData.coins < 3) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç! üí∞');
                return;
            }
            
            const result = Math.random() < 0.5 ? '–æ—Ä—ë–ª' : '—Ä–µ—à–∫–∞';
            const userChoice = prompt('–í—ã–±–µ—Ä–∏—Ç–µ: –æ—Ä—ë–ª –∏–ª–∏ —Ä–µ—à–∫–∞?');
            
            if (userChoice === null) return;
            
            petData.coins -= 3;
            
            if (userChoice.toLowerCase() === result) {
                petData.coins += 6;
                petData.exp += 3;
                showNotification(`üéâ –ü–æ–±–µ–¥–∞! –í—ã–ø–∞–ª ${result}. –ü–æ–ª—É—á–µ–Ω–æ: 6 –º–æ–Ω–µ—Ç, 3 –æ–ø—ã—Ç–∞!`);
            } else {
                showNotification(`üòî –ü—Ä–æ–∏–≥—Ä—ã—à! –í—ã–ø–∞–ª ${result}. –ü–æ—Ç–µ—Ä—è–Ω–æ: 3 –º–æ–Ω–µ—Ç—ã`);
            }
            
            updateDisplay();
            savePetData();
        }
        
        // –ò–≥—Ä–∞ "–ö–æ—Å—Ç–∏"
        function playDiceGame() {
            if (petData.coins < 4) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç! üí∞');
                return;
            }
            
            const dice1 = Math.floor(Math.random() * 6) + 1;
            const dice2 = Math.floor(Math.random() * 6) + 1;
            const sum = dice1 + dice2;
            
            petData.coins -= 4;
            
            if (sum >= 7) {
                petData.coins += 8;
                petData.exp += 4;
                showNotification(`üéâ –ü–æ–±–µ–¥–∞! –ö–æ—Å—Ç–∏: ${dice1} + ${dice2} = ${sum}. –ü–æ–ª—É—á–µ–Ω–æ: 8 –º–æ–Ω–µ—Ç, 4 –æ–ø—ã—Ç–∞!`);
            } else {
                showNotification(`üòî –ü—Ä–æ–∏–≥—Ä—ã—à! –ö–æ—Å—Ç–∏: ${dice1} + ${dice2} = ${sum}. –ü–æ—Ç–µ—Ä—è–Ω–æ: 4 –º–æ–Ω–µ—Ç—ã`);
            }
            
            updateDisplay();
            savePetData();
        }
        
        function showShop() {
            showNotification('–ú–∞–≥–∞–∑–∏–Ω —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω! üõí');
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
    </script>
</body>
</html>